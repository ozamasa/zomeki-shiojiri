<%
  #カレンダーの先頭曜日の指定（0:日曜、1:月曜、、、6:土曜)
  start_w_index = @start_wday

  #カレンダーの開始日が何曜日でも良いように２週分用意しておく
  wday=[{:name=>'日',:num=>0,:class =>"wday sun"},{:name=>'月',:num=>1,:class=>"wday mon"},{:name=>'火',:num=>2,:class=>"wday tue"},
	{:name=>'水',:num=>3,:class=>"wday wed"},{:name=>'木',:num=>4,:class=>"wday thu"},{:name=>'金',:num=>5,:class=>"wday fri"},
	{:name=>'土',:num=>6,:class=>"wday sat"},
	{:name=>'日',:num=>0,:class =>"wday sun"},{:name=>'月',:num=>1,:class=>"wday mon"},{:name=>'火',:num=>2,:class=>"wday tue"},
	{:name=>'水',:num=>3,:class=>"wday wed"},{:name=>'木',:num=>4,:class=>"wday thu"},{:name=>'金',:num=>5,:class=>"wday fri"}]

	base_nbr = @base_nbr
	max_row = @max_row
	max_column = @max_column
%>

<div class="calendarEvents calendarMonthlyEvents">

<%= render 'search_cond' %>
	
<h2><%= sprintf("%d年%d月", @year, @month) %></h2>

<%= @pagination.to_links(:class => "pagination upperPagination") %>

<table border="1">
  <thead class="wdays">
  <tr>
	<% base_nbr.upto(max_column) do |idx| %>
	  <th class="<%= wday[start_w_index + idx][:class] %>"><%= wday[start_w_index + idx][:name]%></th>
	<% end %>
  </tr>
  </thead>
  <% base_nbr.upto(max_row) do |row| %>
  <tr>
	<% base_nbr.upto(max_column) do |column| %>
	  <% this_day = @box[row][column] %>
	  <td style="border:1px solid gray;height:80px;">
	  <% if this_day[:date].month == @month %>
	    <%= this_day[:date].strftime("%d") %><br>
	    <% this_day[:events].each do |item| %>
		  <%= item.event_uri.blank? ? hbr(item.title) : link_to(hbr(item.title), item.event_uri, :target => "_blank") %><br>
		<% end %>
	  </td>
	  <% end %>
	<% end %>
  </tr>
  <% end %>
</table>

<%= @pagination.to_links(:class => "pagination lowerPagination") %>

<!-- end .calendarEvents --></div>
