<%= render 'gp_article/admin/node/shared/form', f: f %>

<%-
  item = instance_variable_get("@#{f.object_name}")
  content = GpArticle::Content::Doc.find(item.content.id)
-%>
<%= javascript_tag do -%>
$(document).ready(function () {
  var item_name = $('#item_name');
  var td = item_name.closest('td');
  item_name.remove();

  var sel = $(document.createElement('select'));
  sel.attr({id: 'item_name', name: 'item[name]'});

  sel.append($(document.createElement('option')).attr({value: ''}).text(''));
  <%- content.category_types.each do |ct| -%>
  sel.append($(document.createElement('option')).attr({value: '<%= ct.name %>'<%= ", selected: 'selected'".html_safe if item.name == ct.name %>}).text('<%= ct.name %> (<%= ct.title %>)'));
  <%- end -%>

  td.append(sel);
});
<%- end -%>
